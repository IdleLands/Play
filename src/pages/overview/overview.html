
<ion-header>

  <ion-navbar color="primary">
    <ion-title>Overview - {{ player.name }}</ion-title>
  </ion-navbar>

</ion-header>


<ion-content padding>
  <ion-grid>
    <ion-row>
      <ion-col width-20 class="size-200" text-center>
        <stat stat="hp" [value]="player.statCache.hp"></stat>
      </ion-col>
      <ion-col width-20 class="size-200" text-center>
        <stat stat="mp" [value]="player.statCache.mp"></stat>
      </ion-col>
      <ion-col width-60 class="size-200" text-right padding-right>
        <game-icon icon="stat-xp"></game-icon> {{ player._xp.__current | number }}/{{ player._xp.maximum | number }} XP
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col *ngFor="let stat of stats" class="size-150" text-center>
        <stat [stat]="stat" [value]="player.statCache[stat]" [showColor]="true"></stat>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-slides [class.hidden]="player.choices.length > 0">
          <ion-slide>
            <ion-card class="choice-card">
              <ion-card-content>
                <h1>You don't have any choices right now. Check back later!</h1>
              </ion-card-content>
            </ion-card>
          </ion-slide>
        </ion-slides>

        <ion-slides [class.hidden]="player.choices.length === 0" slidesPerView="3">
          <ion-slide *ngFor="let choice of choices; let i = index">
            <ion-card class="choice-card">
              <ion-card-header>
                Choice #{{ i+1 }}/{{ player.choices.length }} (Max: {{ player._choiceLimit }})
              </ion-card-header>
              <ion-card-content>
                {{ choice.message }}
              </ion-card-content>
              <ion-row>
                <ion-col *ngFor="let option of choice.choices">
                  <button ion-button clear small (click)="makeChoice(choice.id, option)">
                    <div>{{ option }}</div>
                  </button>
                </ion-col>
                <ion-col *ngIf="choice.event === 'FindItem' || choice.event === 'Merchant'">
                  <button ion-button clear small color="secondary" (click)="moreInfo(choice)">
                    <div>More Info</div>
                  </button>
                </ion-col>
              </ion-row>
            </ion-card>
          </ion-slide>
        </ion-slides>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-card>
          <ion-card-header>Adventure Log</ion-card-header>
          <ion-card-content class="adventure-log" no-padding>
            <ion-list no-padding>
              <ion-item *ngIf="adventureLog.length === 0">
                Your adventure log is empty.
              </ion-item>
              <ion-item no-padding *ngFor="let item of adventureLog; let i = index" text-wrap [color]="i % 2 === 0 ? 'darkstripe' : 'lightstripe'">
                <ion-grid no-padding>
                  <ion-row no-padding>
                    <ion-col width-10 true-center text-center>
                      <advlog-icon [icon]="item.category" class="size-400"></advlog-icon>
                    </ion-col>
                    <ion-col>
                      <ion-note>
                        <span>{{ item.timestamp | date:'medium' }}</span>
                      </ion-note>
                      <div>{{ item.text }}</div>
                      <button ion-button small outline (click)="viewBattle(item.extraData.battleName)" *ngIf="item.extraData?.battleName">View Battle</button>
                      <button ion-button small outline target="_blank" [attr.href]="item.extraData.link" *ngIf="item.extraData?.link">View Link</button>
                    </ion-col>
                  </ion-row>
                </ion-grid>
              </ion-item>
            </ion-list>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
