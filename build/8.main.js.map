{"version":3,"sources":["../../src/pages/overview/overview.module.ts","../../src/pages/overview/overview.ts"],"names":[],"mappings":"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","file":"8.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { MomentModule } from 'angular2-moment';\nimport { GlobalComponentsModule } from '../../components/components.module';\nimport { OverviewPage } from './overview';\nimport { IonicPageModule } from 'ionic-angular';\n\n@NgModule({\n  declarations: [OverviewPage],\n  imports: [GlobalComponentsModule, MomentModule, IonicPageModule.forChild(OverviewPage)]\n})\nexport class OverviewPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/overview/overview.module.ts","import * as _ from 'lodash';\n\nimport { Component, OnInit, OnDestroy, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, AlertController, Platform } from 'ionic-angular';\n\nimport { AppState, Primus, ItemCompare, ItemInfo, Theme } from '../../services';\nimport { PlayComponent } from '../../components/play.component';\n\nimport { AdventureLog, Shop } from '../../models';\n\n@IonicPage({\n  segment: 'overview'\n})\n@Component({\n  selector: 'page-overview',\n  templateUrl: 'overview.html'\n})\nexport class OverviewPage extends PlayComponent implements OnInit, OnDestroy {\n\n  public stats = [];\n  public choices = [];\n\n  public adventureLog$: any;\n  public adventureLog: AdventureLog[] = [];\n\n  public shop$: any;\n  public shop: Shop;\n\n  party$: any;\n  public party: any;\n\n  @ViewChild('choiceSlides') public choiceSlides;\n\n  shopButtons = [\n    { name: 'Buy', callback: (item) => {\n      const equipment = this.appState.equipment.getValue();\n      const buttons = [\n        { text: `Buy for ${item.price.toLocaleString()} gold`, color: 'primary', callback: () => this.primus.buyShopItem(item.id) },\n        { text: 'Close', color: 'light', callback: () => {} }\n      ];\n      this.icomp.compare(equipment[item.type], item, buttons).then(button => {\n        if(!button) return;\n        button.callback();\n      });\n    } }\n  ];\n\n  constructor(\n    public appState: AppState,\n    public primus: Primus,\n    public navCtrl: NavController,\n    public icomp: ItemCompare,\n    public alertCtrl: AlertController,\n    public theme: Theme,\n    public platform: Platform\n  ) {\n    super(appState, primus, navCtrl);\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    this.stats = ItemInfo.statOrder;\n\n    this.adventureLog$ = this.appState.adventureLog.subscribe(data => {\n      if(!this.adventureLog) this.adventureLog = [];\n\n      this.adventureLog.unshift(data);\n      if(this.adventureLog.length > 50) {\n        this.adventureLog.length = 50;\n      }\n    });\n\n    this.shop$ = this.appState.shop.subscribe(data => this.shop = data);\n\n    this.party$ = this.appState.party.subscribe(data => {\n      this.party = data;\n    });\n\n    this.primus.requestEquipment();\n    this.primus.requestParty();\n    this.primus.requestShop();\n  }\n\n  ngOnDestroy() {\n    this.adventureLog$.unsubscribe();\n    this.party$.unsubscribe();\n    this.shop$.unsubscribe();\n  }\n\n  get equipment() {\n    return this.appState.equipment.getValue();\n  }\n\n  get numSlides() {\n    return this.platform.is('ios') || this.platform.is('android') ? 1 : 3;\n  }\n\n  setPlayer(player) {\n    super.setPlayer(player);\n\n    this.setChoices(player.choices);\n  }\n\n  setChoices(choices) {\n    const add = _.differenceBy(choices, this.choices, 'id');\n    const remove = _.map(_.differenceBy(this.choices, choices, 'id'), 'id');\n    this.choices.push(...add);\n    this.choices = _.reject(this.choices, choice => _.includes(remove, choice.id));\n\n    if(this.choices.length < 4 && this.choices.length > 0) {\n      try {\n        this.choiceSlides.slideTo(0);\n      } catch(e) {}\n    }\n  }\n\n  makeChoice(id, choice) {\n    this.primus.makeChoice(id, choice);\n\n    if(choice === 'Yes') {\n      this.primus.requestEquipment();\n    }\n  }\n\n  moreInfo(choice) {\n    const choiceItem = choice.extraData.item;\n    const equipment = this.appState.equipment.getValue();\n    const playerItem = equipment[choiceItem.type] || { str: 0, dex: 0, con: 0, int: 0, agi: 0, luk: 0, _baseScore: 1, _calcScore: 1 };\n\n    const buttons = [\n      { text: 'Equip',      color: 'primary', callback: () => this.makeChoice(choice.id, 'Yes') },\n      { text: 'Discard',    color: 'danger',  callback: () => this.makeChoice(choice.id, 'No') },\n      { text: 'Close',      color: 'light',   callback: () => {} }\n    ];\n\n    this.icomp.compare(playerItem, choiceItem, buttons).then(button => {\n      if(!button) return;\n      button.callback();\n    });\n  }\n\n  openLink(link) {\n    window.open(link, '_blank');\n  }\n\n  viewBattle(id) {\n    this.navCtrl.push('BattlePage', { battleName: id });\n  }\n\n  leaveParty() {\n    this.primus.leaveParty();\n  }\n\n  ascend() {\n\n    this.alertCtrl.create({\n      cssClass: this.theme.currentTheme,\n      title: 'Ascension Confirmation',\n      message: `Are you sure you want to ascend? <br><br>You will: go back to level 1, \n                lose all of your items, lose all of your pet items, lose all of your gold, lose all of your pet gold, \n                and lose all of your collectibles. <br><br>In return, you will: increase your maximum level by 50, have a bonus to gold find and xp gain,\n                go up one ascension level, and create an experience and gold festival for all players. Your collectibles will be remembered.`,\n      buttons: [\n        { text: 'No, Nevermind' },\n        {\n          text: 'Yes, Ascend',\n          handler: () => {\n            this.primus.ascend();\n          }\n        }\n      ]\n    }).present();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/overview/overview.ts"],"sourceRoot":""}