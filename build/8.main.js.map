{"version":3,"sources":["../../src/pages/overview/overview.module.ts","../../src/pages/overview/overview.ts"],"names":[],"mappings":"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","file":"8.main.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { MomentModule } from 'angular2-moment';\r\nimport { GlobalComponentsModule } from '../../components/components.module';\r\nimport { OverviewPage } from './overview';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\n@NgModule({\r\n  declarations: [OverviewPage],\r\n  imports: [GlobalComponentsModule, MomentModule, IonicPageModule.forChild(OverviewPage)]\r\n})\r\nexport class OverviewPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/overview/overview.module.ts","import * as _ from 'lodash';\r\n\r\nimport { Component, OnInit, OnDestroy, ViewChild } from '@angular/core';\r\nimport { IonicPage, NavController, AlertController, Platform } from 'ionic-angular';\r\n\r\nimport { AppState, Primus, ItemCompare, ItemInfo, Theme } from '../../services';\r\nimport { PlayComponent } from '../../components/play.component';\r\n\r\nimport { AdventureLog, Shop } from '../../models';\r\n\r\n@IonicPage({\r\n  segment: 'overview'\r\n})\r\n@Component({\r\n  selector: 'page-overview',\r\n  templateUrl: 'overview.html'\r\n})\r\nexport class OverviewPage extends PlayComponent implements OnInit, OnDestroy {\r\n\r\n  public stats = [];\r\n  public choices = [];\r\n\r\n  public adventureLog$: any;\r\n  public adventureLog: AdventureLog[] = [];\r\n\r\n  public shop$: any;\r\n  public shop: Shop;\r\n\r\n  party$: any;\r\n  public party: any;\r\n  \r\n  @ViewChild('choiceSlides') public choiceSlides;\r\n\r\n  shopButtons = [\r\n    { name: 'Buy', callback: (item) => {\r\n      const equipment = this.appState.equipment.getValue();\r\n      const buttons = [\r\n        { text: `Buy for ${item.price.toLocaleString()} gold`, color: 'primary', callback: () => this.primus.buyShopItem(item.id) },\r\n        { text: 'Close', color: 'light', callback: () => {} }\r\n      ];\r\n      this.icomp.compare(equipment[item.type], item, buttons).then(button => {\r\n        if(!button) return;\r\n        button.callback();\r\n      });\r\n    } }\r\n  ];\r\n\r\n  constructor(\r\n    public appState: AppState,\r\n    public primus: Primus,\r\n    public navCtrl: NavController,\r\n    public icomp: ItemCompare,\r\n    public alertCtrl: AlertController,\r\n    public theme: Theme,\r\n    public platform: Platform\r\n  ) {\r\n    super(appState, primus, navCtrl);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n\r\n    this.stats = ItemInfo.statOrder;\r\n\r\n    this.adventureLog$ = this.appState.adventureLog.subscribe(data => {\r\n      if(!this.adventureLog) this.adventureLog = [];\r\n\r\n      this.adventureLog.unshift(data);\r\n      if(this.adventureLog.length > 50) {\r\n        this.adventureLog.length = 50;\r\n      }\r\n    });\r\n\r\n    this.shop$ = this.appState.shop.subscribe(data => this.shop = data);\r\n\r\n    this.party$ = this.appState.party.subscribe(data => {\r\n      this.party = data;\r\n    });\r\n\r\n    this.primus.requestEquipment();\r\n    this.primus.requestParty();\r\n    this.primus.requestShop();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.adventureLog$.unsubscribe();\r\n    this.party$.unsubscribe();\r\n    this.shop$.unsubscribe();\r\n  }\r\n\r\n  get equipment() {\r\n    return this.appState.equipment.getValue();\r\n  }\r\n\r\n  get numSlides() {\r\n    return this.platform.is('ios') || this.platform.is('android') ? 1 : 3;\r\n  }\r\n\r\n  setPlayer(player) {\r\n    super.setPlayer(player);\r\n\r\n    this.setChoices(player.choices);\r\n  }\r\n\r\n  setChoices(choices) {\r\n    const add = _.differenceBy(choices, this.choices, 'id');\r\n    const remove = _.map(_.differenceBy(this.choices, choices, 'id'), 'id');\r\n    this.choices.push(...add);\r\n    this.choices = _.reject(this.choices, choice => _.includes(remove, choice.id));\r\n\r\n    if(this.choices.length < 4 && this.choices.length > 0) {\r\n      try {\r\n        this.choiceSlides.slideTo(0);\r\n      } catch(e) {}\r\n    }\r\n  }\r\n\r\n  makeChoice(id, choice) {\r\n    this.primus.makeChoice(id, choice);\r\n\r\n    if(choice === 'Yes') {\r\n      this.primus.requestEquipment();\r\n    }\r\n  }\r\n\r\n  moreInfo(choice) {\r\n    const choiceItem = choice.extraData.item;\r\n    const equipment = this.appState.equipment.getValue();\r\n    const playerItem = equipment[choiceItem.type] || { str: 0, dex: 0, con: 0, int: 0, agi: 0, luk: 0, _baseScore: 1, _calcScore: 1 };\r\n\r\n    const buttons = [\r\n      { text: 'Equip',      color: 'primary',    callback: () => this.makeChoice(choice.id, 'Yes') },\r\n      { text: 'Discard',    color: 'danger',     callback: () => this.makeChoice(choice.id, 'No') },\r\n      { text: 'Pet',        color: 'secondary',  callback: () => this.makeChoice(choice.id, 'Pet') },\r\n      { text: 'Close',      color: 'light',      callback: () => {} }\r\n    ];\r\n    if(choice.choices.indexOf('Pet') < 0) buttons.splice(2, 1);\r\n\r\n    this.icomp.compare(playerItem, choiceItem, buttons).then(button => {\r\n      if(!button) return;\r\n      button.callback();\r\n    });\r\n  }\r\n\r\n  openLink(link) {\r\n    window.open(link, '_blank');\r\n  }\r\n\r\n  viewBattle(id) {\r\n    this.navCtrl.push('BattlePage', { battleName: id });\r\n  }\r\n\r\n  leaveParty() {\r\n    this.primus.leaveParty();\r\n  }\r\n\r\n  ascend() {\r\n\r\n    this.alertCtrl.create({\r\n      cssClass: this.theme.currentTheme,\r\n      title: 'Ascension Confirmation',\r\n      message: `Are you sure you want to ascend? <br><br>You will: go back to level 1, \r\n                lose all of your items, lose all of your pet items, lose all of your gold, lose all of your pet gold, \r\n                and lose all of your collectibles. <br><br>In return, you will: increase your maximum level by 50, have a bonus to gold find and xp gain,\r\n                go up one ascension level, and create an experience and gold festival for all players. Your collectibles will be remembered.`,\r\n      buttons: [\r\n        { text: 'No, Nevermind' },\r\n        {\r\n          text: 'Yes, Ascend',\r\n          handler: () => {\r\n            this.primus.ascend();\r\n          }\r\n        }\r\n      ]\r\n    }).present();\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/overview/overview.ts"],"sourceRoot":""}