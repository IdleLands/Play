{"version":3,"sources":["../../src/pages/premium/premium.module.ts","../../src/pages/premium/premium.ts"],"names":[],"mappings":"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","file":"6.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { PremiumPage } from './premium';\nimport { MomentModule } from 'angular2-moment';\nimport { IonicPageModule } from 'ionic-angular';\n\n@NgModule({\n  declarations: [PremiumPage],\n  imports: [MomentModule, IonicPageModule.forChild(PremiumPage)],\n})\nexport class PremiumPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/premium/premium.module.ts","import * as _ from 'lodash';\n\nimport { Component, OnInit, OnDestroy } from '@angular/core';\nimport { IonicPage, NavController, AlertController } from 'ionic-angular';\n\nimport { AppState, Primus, Theme } from '../../services';\nimport { PlayComponent } from '../../components/play.component';\n\nimport { Premium, Festival } from '../../models';\n\n@IonicPage({\n  segment: 'premium'\n})\n@Component({\n  selector: 'page-premium',\n  templateUrl: 'premium.html'\n})\nexport class PremiumPage extends PlayComponent implements OnInit, OnDestroy {\n\n  public ilpGoldMargins = [50, 500, 1000, 2500];\n\n  private customMultipliers = {\n    salvage: 10\n  };\n\n  premium$: any;\n  premium: Premium = new Premium();\n\n  festivals$: any;\n  festivals: Festival[];\n\n  constructor(\n    public appState: AppState,\n    public primus: Primus,\n    public navCtrl: NavController,\n    public alertCtrl: AlertController,\n    public theme: Theme\n  ) {\n    super(appState, primus, navCtrl);\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    this.premium$ = this.appState.premium.subscribe(data => this.setPremium(data));\n    this.festivals$ = this.appState.festivals.subscribe(data => this.setFestivals(data));\n  }\n\n  ngOnDestroy() {\n    super.ngOnDestroy();\n\n    this.premium$.unsubscribe();\n    this.festivals$.unsubscribe();\n  }\n\n  getTotalFestival(): Festival {\n    const base = {\n      name: 'All Festivals',\n      endDate: _.maxBy(this.festivals, fest => new Date(fest.endDate).getTime()).endDate,\n      bonuses: {},\n      uncloseable: true\n    };\n\n    _.each(this.festivals, fest => {\n      _.each(_.keys(fest.bonuses), bonusKey => {\n        if(!base.bonuses[bonusKey]) base.bonuses[bonusKey] = 0;\n        base.bonuses[bonusKey] += fest.bonuses[bonusKey];\n      });\n    });\n\n    return base;\n  }\n\n  setFestivals(festivals) {\n    this.festivals = _.cloneDeep(festivals);\n    if(this.festivals.length > 0) {\n      this.festivals.unshift(this.getTotalFestival());\n    }\n  }\n\n  festivalBonus(festivalBonuses) {\n    return _.map(_.keys(festivalBonuses), key => {\n      let multiplier = this.customMultipliers[key];\n      if(!multiplier) multiplier = 100;\n\n      return `${key.toUpperCase()} +${(festivalBonuses[key] * multiplier).toFixed(0)}`;\n    });\n  }\n\n  setPremium(premium) {\n    this.premium = premium;\n    this.updatePageData(`Your ILP: ${premium.ilp.toLocaleString()}`);\n  }\n\n  buyIlp(ilpToBuy: number) {\n    this.alertCtrl.create({\n      cssClass: this.theme.currentTheme,\n      title: `Buy ILP`,\n      message: `Are you sure you want to buy ${ilpToBuy.toLocaleString()} ILP?`,\n      buttons: [\n        { text: 'Cancel' },\n        { text: 'Yes, Please!', handler: () => {\n          this.primus.buyIlp(ilpToBuy);\n        } }\n      ]\n    }).present();\n  }\n\n  buyIlpItem(item: string) {\n    this.alertCtrl.create({\n      cssClass: this.theme.currentTheme,\n      title: `Buy ${item}`,\n      message: `Are you sure you want to buy ${item}?`,\n      buttons: [\n        { text: 'Cancel' },\n        { text: 'Yes, Please!', handler: () => {\n          this.primus.buyIlpItem(item);\n        } }\n      ]\n    }).present();\n  }\n\n  createFestival() {\n    this.alertCtrl.create({\n      cssClass: this.theme.currentTheme,\n      title: `Create Festival`,\n      message: 'Enter the festival text here. Don\\'t forget the bonuses and the hour duration!',\n      inputs: [\n        { type: 'text', name: 'festival', placeholder: '\"Festival Name\" xp=0.15 hours=24' }\n      ],\n      buttons: [\n        { text: 'Cancel' },\n        { text: 'Create Festival', handler: (data) => {\n          this.primus.createFestival(data.festival);\n        } }\n      ]\n    }).present();\n  }\n\n  cancelFestival(festival) {\n    this.alertCtrl.create({\n      cssClass: this.theme.currentTheme,\n      title: 'Cancel Festival',\n      message: 'Are you sure you want to do this? The players will be very sad :(',\n      buttons: [\n        { text: 'No, Keep It' },\n        { text: 'Yes, Cancel It', handler: () => {\n          this.primus.cancelFestival(festival._id);\n        } }\n      ]\n    }).present();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/premium/premium.ts"],"sourceRoot":""}