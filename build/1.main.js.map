{"version":3,"sources":["../../src/pages/statistics/statistics.module.ts","../../src/pages/statistics/statistics-tree.component.ts","../../src/pages/statistics/statistics.ts"],"names":[],"mappings":"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","file":"1.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { StatisticsPage } from './statistics';\nimport { StatisticsTreeComponent } from './statistics-tree.component';\nimport { IonicPageModule } from 'ionic-angular';\n\n@NgModule({\n  declarations: [StatisticsPage, StatisticsTreeComponent],\n  imports: [IonicPageModule.forChild(StatisticsPage)],\n})\nexport class SettingsPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/statistics/statistics.module.ts","\nimport { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'statistics-tree',\n  styles: [`\n    :host ul {\n      list-style-type: none;\n    }\n    \n    :host ul:not(.is-first) {\n      margin-left: -20px;\n    }\n    \n    :host ul.is-first {\n      padding-left: 0;\n    }\n  `],\n  template: `\n    <ul [class.is-first]=\"isFirst\">\n      <li *ngFor=\"let node of treeData\">\n        <strong>{{ node.name }}</strong> {{ node.val | number }}\n        <statistics-tree [treeData]=\"node.children\"></statistics-tree>\n      </li>\n    </ul>\n  `\n})\nexport class StatisticsTreeComponent {\n  @Input() public treeData: any = [];\n  @Input() public isFirst: boolean;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/statistics/statistics-tree.component.ts","import * as _ from 'lodash';\n\nimport { Component, OnInit, OnDestroy } from '@angular/core';\nimport { IonicPage, NavController } from 'ionic-angular';\n\nimport { AppState, Primus } from '../../services';\nimport { PlayComponent } from '../../components/play.component';\n\nimport { Statistics } from '../../models';\n\n@IonicPage({\n  segment: 'statistics'\n})\n@Component({\n  selector: 'page-statistics',\n  templateUrl: 'statistics.html'\n})\nexport class StatisticsPage extends PlayComponent implements OnInit, OnDestroy {\n\n  statistics$: any;\n  statistics: Statistics;\n\n  private ignoreRecurseKeys = ['BossKills', 'Maps', 'Regions'];\n\n  constructor(\n    public appState: AppState,\n    public primus: Primus,\n    public navCtrl: NavController\n  ) {\n    super(appState, primus, navCtrl);\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    this.statistics$ = this.appState.statistics.subscribe(data => {\n      this.setStatistics(data);\n    });\n\n    this.primus.requestStatistics();\n  }\n\n  ngOnDestroy() {\n    super.ngOnDestroy();\n\n    this.statistics$.unsubscribe();\n  }\n\n  setStatistics(data: Statistics) {\n    const BossKills = _.get(data, 'Character.BossKills', {});\n    const Maps = _.get(data, 'Character.Maps', {});\n    const Regions = _.get(data, 'Character.Regions', {});\n\n    (<any>data).BossKills = BossKills;\n    (<any>data).Maps = Maps;\n    (<any>data).Regions = Regions;\n\n    const recurse = (obj, isRoot = false) => {\n      return _.map(obj, (val, key) => {\n        const baseObj: any = {};\n\n        if(!isRoot && _.includes(this.ignoreRecurseKeys, key)) return {};\n\n        baseObj.name = key;\n\n        if(_.isObject(val)) {\n          baseObj.children = recurse(val);\n        } else {\n          baseObj.val = val;\n        }\n\n        return baseObj;\n      });\n    };\n\n    const sortAll = (data) => {\n      _.each(data, obj => {\n        if(!obj.children) return;\n\n        obj.children = sortAll(obj.children);\n      });\n\n      return _.sortBy(data, 'name');\n    };\n\n    this.statistics = _.reduce(_.reject(sortAll(recurse(data, true)), item => item.val), (prev, item) => {\n      prev[item.name] = item;\n      return prev;\n    }, {});\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/statistics/statistics.ts"],"sourceRoot":""}