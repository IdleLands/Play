{"version":3,"sources":["../../src/pages/statistics/statistics.module.ts","../../src/pages/statistics/statistics-tree.component.ts","../../src/pages/statistics/statistics.ts"],"names":[],"mappings":"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","file":"1.main.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { StatisticsPage } from './statistics';\r\nimport { StatisticsTreeComponent } from './statistics-tree.component';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\n@NgModule({\r\n  declarations: [StatisticsPage, StatisticsTreeComponent],\r\n  imports: [IonicPageModule.forChild(StatisticsPage)],\r\n})\r\nexport class SettingsPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/statistics/statistics.module.ts","\r\nimport { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'statistics-tree',\r\n  styles: [`\r\n    :host ul {\r\n      list-style-type: none;\r\n    }\r\n    \r\n    :host ul:not(.is-first) {\r\n      margin-left: -20px;\r\n    }\r\n    \r\n    :host ul.is-first {\r\n      padding-left: 0;\r\n    }\r\n  `],\r\n  template: `\r\n    <ul [class.is-first]=\"isFirst\">\r\n      <li *ngFor=\"let node of treeData\">\r\n        <strong>{{ node.name }}</strong> {{ node.val | number }}\r\n        <statistics-tree [treeData]=\"node.children\"></statistics-tree>\r\n      </li>\r\n    </ul>\r\n  `\r\n})\r\nexport class StatisticsTreeComponent {\r\n  @Input() public treeData: any = [];\r\n  @Input() public isFirst: boolean;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/statistics/statistics-tree.component.ts","import * as _ from 'lodash';\r\n\r\nimport { Component, OnInit, OnDestroy } from '@angular/core';\r\nimport { IonicPage, NavController } from 'ionic-angular';\r\n\r\nimport { AppState, Primus } from '../../services';\r\nimport { PlayComponent } from '../../components/play.component';\r\n\r\nimport { Statistics } from '../../models';\r\n\r\n@IonicPage({\r\n  segment: 'statistics'\r\n})\r\n@Component({\r\n  selector: 'page-statistics',\r\n  templateUrl: 'statistics.html'\r\n})\r\nexport class StatisticsPage extends PlayComponent implements OnInit, OnDestroy {\r\n\r\n  statistics$: any;\r\n  statistics: Statistics;\r\n\r\n  private ignoreRecurseKeys = ['BossKills', 'Maps', 'Regions'];\r\n\r\n  constructor(\r\n    public appState: AppState,\r\n    public primus: Primus,\r\n    public navCtrl: NavController\r\n  ) {\r\n    super(appState, primus, navCtrl);\r\n  }\r\n\r\n  ngOnInit() {\r\n    super.ngOnInit();\r\n\r\n    this.statistics$ = this.appState.statistics.subscribe(data => {\r\n      this.setStatistics(data);\r\n    });\r\n\r\n    this.primus.requestStatistics();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    super.ngOnDestroy();\r\n\r\n    this.statistics$.unsubscribe();\r\n  }\r\n\r\n  setStatistics(data: Statistics) {\r\n    const BossKills = _.get(data, 'Character.BossKills', {});\r\n    const Maps = _.get(data, 'Character.Maps', {});\r\n    const Regions = _.get(data, 'Character.Regions', {});\r\n\r\n    (<any>data).BossKills = BossKills;\r\n    (<any>data).Maps = Maps;\r\n    (<any>data).Regions = Regions;\r\n\r\n    const recurse = (obj, isRoot = false) => {\r\n      return _.map(obj, (val, key) => {\r\n        const baseObj: any = {};\r\n\r\n        if(!isRoot && _.includes(this.ignoreRecurseKeys, key)) return {};\r\n\r\n        baseObj.name = key;\r\n\r\n        if(_.isObject(val)) {\r\n          baseObj.children = recurse(val);\r\n        } else {\r\n          baseObj.val = val;\r\n        }\r\n\r\n        return baseObj;\r\n      });\r\n    };\r\n\r\n    const sortAll = (data) => {\r\n      _.each(data, obj => {\r\n        if(!obj.children) return;\r\n\r\n        obj.children = sortAll(obj.children);\r\n      });\r\n\r\n      return _.sortBy(data, 'name');\r\n    };\r\n\r\n    this.statistics = _.reduce(_.reject(sortAll(recurse(data, true)), item => item.val), (prev, item) => {\r\n      prev[item.name] = item;\r\n      return prev;\r\n    }, {});\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/statistics/statistics.ts"],"sourceRoot":""}